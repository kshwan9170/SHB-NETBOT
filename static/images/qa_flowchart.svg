<?xml version="1.0" encoding="UTF-8"?>
<svg width="1200" height="1400" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box { fill: #f8f9fa; stroke: #2563eb; stroke-width: 2; }
      .decision { fill: #fef3c7; stroke: #f59e0b; stroke-width: 2; }
      .process { fill: #dcfce7; stroke: #16a34a; stroke-width: 2; }
      .endpoint { fill: #dbeafe; stroke: #2563eb; stroke-width: 2; }
      .text { font-family: Arial, sans-serif; font-size: 12px; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 14px; font-weight: bold; text-anchor: middle; }
      .arrow { stroke: #374151; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .yes-label { font-family: Arial, sans-serif; font-size: 10px; fill: #16a34a; font-weight: bold; }
      .no-label { font-family: Arial, sans-serif; font-size: 10px; fill: #dc2626; font-weight: bold; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#374151" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" class="title" style="font-size: 18px; fill: #1f2937;">SHB-NetBot 질문 답변 플로우 차트</text>
  
  <!-- Start -->
  <ellipse cx="600" cy="80" rx="80" ry="25" class="endpoint"/>
  <text x="600" y="85" class="title">사용자 질문 입력</text>
  
  <!-- Question Processing -->
  <rect x="520" y="130" width="160" height="50" rx="5" class="box"/>
  <text x="600" y="150" class="text">질문 전처리</text>
  <text x="600" y="165" class="text">(언어 감지, 정규화)</text>
  
  <!-- Meaningless Check -->
  <polygon points="550,220 650,220 680,250 650,280 550,280 520,250" class="decision"/>
  <text x="600" y="245" class="text">무의미한</text>
  <text x="600" y="260" class="text">질문인가?</text>
  
  <!-- Meaningless Response -->
  <rect x="720" y="225" width="140" height="50" rx="5" class="endpoint"/>
  <text x="790" y="245" class="text">무의미한 질문</text>
  <text x="790" y="260" class="text">안내 메시지</text>
  
  <!-- IP Request Check -->
  <polygon points="550,320 650,320 680,350 650,380 550,380 520,350" class="decision"/>
  <text x="600" y="345" class="text">IP 주소</text>
  <text x="600" y="360" class="text">신청 질문?</text>
  
  <!-- IP Request Response -->
  <rect x="720" y="325" width="140" height="50" rx="5" class="endpoint"/>
  <text x="790" y="345" class="text">IP 주소 신청서</text>
  <text x="790" y="360" class="text">양식 제공</text>
  
  <!-- Connection Status Check -->
  <polygon points="550,420 650,420 680,450 650,480 550,480 520,450" class="decision"/>
  <text x="600" y="445" class="text">온라인</text>
  <text x="600" y="460" class="text">상태?</text>
  
  <!-- Offline Processing -->
  <rect x="350" y="525" width="140" height="50" rx="5" class="process"/>
  <text x="420" y="545" class="text">오프라인 모드</text>
  <text x="420" y="560" class="text">로컬 데이터 검색</text>
  
  <!-- Online Processing -->
  <rect x="650" y="525" width="140" height="50" rx="5" class="process"/>
  <text x="720" y="545" class="text">온라인 모드</text>
  <text x="720" y="560" class="text">Excel 데이터 처리</text>
  
  <!-- Excel Processing -->
  <polygon points="700,600 820,600 850,630 820,660 700,660 670,630" class="decision"/>
  <text x="760" y="625" class="text">Excel에서</text>
  <text x="760" y="640" class="text">결과 발견?</text>
  
  <!-- Excel Response -->
  <rect x="890" y="605" width="140" height="50" rx="5" class="endpoint"/>
  <text x="960" y="625" class="text">Excel 기반</text>
  <text x="960" y="640" class="text">구조화된 응답</text>
  
  <!-- RAG Processing -->
  <rect x="650" y="700" width="140" height="50" rx="5" class="process"/>
  <text x="720" y="720" class="text">RAG 시스템</text>
  <text x="720" y="735" class="text">벡터 검색</text>
  
  <!-- Document Search -->
  <rect x="650" y="780" width="140" height="50" rx="5" class="process"/>
  <text x="720" y="800" class="text">관련 문서 검색</text>
  <text x="720" y="815" class="text">(ChromaDB)</text>
  
  <!-- AI Response Generation -->
  <rect x="650" y="860" width="140" height="50" rx="5" class="process"/>
  <text x="720" y="880" class="text">AI 응답 생성</text>
  <text x="720" y="895" class="text">(OpenAI GPT)</text>
  
  <!-- Context Check -->
  <polygon points="370,600 470,600 500,630 470,660 370,660 340,630" class="decision"/>
  <text x="420" y="625" class="text">로컬에서</text>
  <text x="420" y="640" class="text">답변 발견?</text>
  
  <!-- Local Response -->
  <rect x="180" y="605" width="140" height="50" rx="5" class="endpoint"/>
  <text x="250" y="625" class="text">오프라인 기반</text>
  <text x="250" y="640" class="text">응답 제공</text>
  
  <!-- No Local Data -->
  <rect x="350" y="700" width="140" height="50" rx="5" class="endpoint"/>
  <text x="420" y="720" class="text">연결 제한 안내</text>
  <text x="420" y="735" class="text">메시지</text>
  
  <!-- Statistics Recording -->
  <rect x="520" y="940" width="160" height="50" rx="5" class="process"/>
  <text x="600" y="960" class="text">질문 통계 기록</text>
  <text x="600" y="975" class="text">(쿼리 분석용)</text>
  
  <!-- Final Response -->
  <ellipse cx="600" cy="1050" rx="100" ry="30" class="endpoint"/>
  <text x="600" y="1050" class="title">사용자에게</text>
  <text x="600" y="1065" class="title">최종 응답 전달</text>
  
  <!-- Flow Arrows -->
  <line x1="600" y1="105" x2="600" y2="130" class="arrow"/>
  <line x1="600" y1="180" x2="600" y2="220" class="arrow"/>
  
  <!-- Meaningless branch -->
  <line x1="680" y1="250" x2="720" y2="250" class="arrow"/>
  <text x="695" y="245" class="yes-label">Yes</text>
  
  <!-- Continue to IP check -->
  <line x1="600" y1="280" x2="600" y2="320" class="arrow"/>
  <text x="615" y="305" class="no-label">No</text>
  
  <!-- IP Request branch -->
  <line x1="680" y1="350" x2="720" y2="350" class="arrow"/>
  <text x="695" y="345" class="yes-label">Yes</text>
  
  <!-- Continue to connection check -->
  <line x1="600" y1="380" x2="600" y2="420" class="arrow"/>
  <text x="615" y="405" class="no-label">No</text>
  
  <!-- Offline branch -->
  <line x1="520" y1="450" x2="420" y2="525" class="arrow"/>
  <text x="465" y="485" class="no-label">Offline</text>
  
  <!-- Online branch -->
  <line x1="680" y1="450" x2="720" y2="525" class="arrow"/>
  <text x="705" y="485" class="yes-label">Online</text>
  
  <!-- Offline processing -->
  <line x1="420" y1="575" x2="420" y2="600" class="arrow"/>
  
  <!-- Offline decision -->
  <line x1="340" y1="630" x2="250" y2="630" class="arrow"/>
  <text x="290" y="625" class="yes-label">Yes</text>
  
  <line x1="420" y1="660" x2="420" y2="700" class="arrow"/>
  <text x="435" y="685" class="no-label">No</text>
  
  <!-- Online processing -->
  <line x1="720" y1="575" x2="760" y2="600" class="arrow"/>
  
  <!-- Excel found -->
  <line x1="850" y1="630" x2="960" y2="630" class="arrow"/>
  <text x="900" y="625" class="yes-label">Yes</text>
  
  <!-- Excel not found, go to RAG -->
  <line x1="720" y1="660" x2="720" y2="700" class="arrow"/>
  <text x="735" y="685" class="no-label">No</text>
  
  <!-- RAG flow -->
  <line x1="720" y1="750" x2="720" y2="780" class="arrow"/>
  <line x1="720" y1="830" x2="720" y2="860" class="arrow"/>
  
  <!-- Statistics recording -->
  <line x1="720" y1="910" x2="720" y2="940" class="arrow"/>
  <line x1="250" y1="655" x2="250" y2="940" class="arrow"/>
  <line x1="250" y1="940" x2="520" y2="940" class="arrow"/>
  <line x1="420" y1="750" x2="420" y2="940" class="arrow"/>
  <line x1="420" y1="940" x2="520" y2="940" class="arrow"/>
  <line x1="790" y1="275" x2="790" y2="940" class="arrow"/>
  <line x1="790" y1="940" x2="680" y2="940" class="arrow"/>
  <line x1="790" y1="375" x2="790" y2="940" class="arrow"/>
  <line x1="960" y1="655" x2="960" y2="940" class="arrow"/>
  <line x1="960" y1="940" x2="680" y2="940" class="arrow"/>
  
  <!-- Final response -->
  <line x1="600" y1="990" x2="600" y2="1020" class="arrow"/>
  
  <!-- Legend -->
  <rect x="50" y="1200" width="300" height="150" fill="none" stroke="#374151" stroke-width="1"/>
  <text x="200" y="1220" class="title">범례</text>
  
  <rect x="70" y="1240" width="40" height="20" class="box"/>
  <text x="120" y="1252" class="text" style="text-anchor: start;">일반 처리</text>
  
  <polygon points="70,1270 90,1270 100,1280 90,1290 70,1290 60,1280" class="decision"/>
  <text x="110" y="1282" class="text" style="text-anchor: start;">판단/분기</text>
  
  <rect x="70" y="1300" width="40" height="20" class="process"/>
  <text x="120" y="1312" class="text" style="text-anchor: start;">핵심 처리</text>
  
  <rect x="70" y="1330" width="40" height="20" class="endpoint"/>
  <text x="120" y="1342" class="text" style="text-anchor: start;">응답/종료</text>
</svg>